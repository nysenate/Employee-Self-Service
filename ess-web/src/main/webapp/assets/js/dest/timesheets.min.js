/*! senate-timesheets - v - 2016-06-10 *//*! Login Page */
var essApp=angular.module("ess");essApp.factory("LoginApi",["$resource","appProps",function(a,b){return a(b.ctxPath+b.loginUrl,{},{login:{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0}})}]),essApp.controller("LoginController",["$scope","$http","$window","appProps","LoginApi",function(a,b,c,d,e){a.credentials={username:"",password:"",rememberMe:!1},a.activeView=1,a.showError=!1,a.errorFields={username:!1,password:!1,reset:function(){this.username=!1,this.password=!1}},a.errorMessage="",a.loginInProgress=!1,a.isActiveView=function(a){return this.activeView===a},a.setActiveView=function(a){this.activeView=a},a.validate=function(){if(a.errorFields.reset(),a.showError=!1,a.credentials.username){if(a.credentials.password)return!0;a.errorMessage="Please enter your password.",a.errorFields.password=!0}else a.errorMessage="Please enter your username.",a.errorFields.username=!0;return a.showError=!0,!1},a.login=function(){a.validate()&&(a.loginInProgress=!0,e.login($.param(a.credentials),function(b,d){b&&(b.authenticated===!0?c.location.href=b.redirectUrl:(a.errorMessage=b.message,a.showError=!0,"UNKNOWN_ACCOUNT"==b.status?a.errorFields.username=!0:"INCORRECT_CREDENTIALS"==b.status&&(a.errorFields.password=!0),a.loginInProgress=!1))},function(b){a.loginInProgress=!1,alert("There was an issue logging in. Please try again.")}))}}]);