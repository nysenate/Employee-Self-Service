/*! ess - v - 2017-04-13 */
var essApp = angular.module("ess");

essApp.factory("LoginApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.ctxPath + appProps.loginUrl, {}, {
        login: {
            method: "POST",
            headers: {
                Accept: "application/json",
                "Content-Type": "application/x-www-form-urlencoded"
            },
            withCredentials: !0
        }
    });
} ]), essApp.controller("LoginController", [ "$scope", "$http", "$window", "appProps", "LoginApi", function($scope, $http, $window, appProps, LoginApi) {
    $scope.credentials = {
        username: "",
        password: "",
        rememberMe: !1
    }, $scope.activeView = 1, $scope.showError = !1, $scope.errorFields = {
        username: !1,
        password: !1,
        reset: function() {
            this.username = !1, this.password = !1;
        }
    }, $scope.errorMessage = "", $scope.loginInProgress = !1, $scope.isActiveView = function(index) {
        return this.activeView === index;
    }, $scope.setActiveView = function(index) {
        this.activeView = index;
    }, $scope.validate = function() {
        if ($scope.errorFields.reset(), $scope.showError = !1, $scope.credentials.username) {
            if ($scope.credentials.password) return !0;
            $scope.errorMessage = "Please enter your password.", $scope.errorFields.password = !0;
        } else $scope.errorMessage = "Please enter your username.", $scope.errorFields.username = !0;
        return $scope.showError = !0, !1;
    }, $scope.login = function() {
        $scope.validate() && ($scope.loginInProgress = !0, LoginApi.login($.param($scope.credentials), function(authResponse, status) {
            authResponse && (authResponse.authenticated === !0 ? $window.location.href = authResponse.redirectUrl : ($scope.errorMessage = authResponse.message, 
            $scope.showError = !0, "UNKNOWN_ACCOUNT" == authResponse.status ? $scope.errorFields.username = !0 : "INCORRECT_CREDENTIALS" == authResponse.status && ($scope.errorFields.password = !0), 
            $scope.loginInProgress = !1));
        }, function(data) {
            $scope.loginInProgress = !1, alert("There was an issue logging in. Please try again.");
        }));
    };
} ]);
//# sourceMappingURL=ess-login.min.js.map