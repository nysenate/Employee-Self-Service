/*! ess - v - 2018-03-23 */
function progressModal() {
    function link($scope, $elem, $attrs) {
        $scope.title = $attrs.title;
    }
    return {
        template: '<div class="progress-modal"><h3 class="content-info" ng-bind="title"></h3><div loader-indicator class="loader"></div></div>',
        link: link
    };
}

function confirmModal(modals) {
    function link($scope, $elem, $attrs) {
        $scope.resolve = modals.resolve, $scope.reject = modals.reject, $scope.rejectable = "true" === $attrs.rejectable, 
        $scope.title = $attrs.title, $scope.level = $attrs.level || "info", $scope.confirmMessage = $attrs.confirmMessage, 
        $scope.resolveButton = $attrs.resolveButton, $scope.rejectButton = $attrs.rejectButton, 
        $scope.resolveClass = $attrs.resolveClass || "submit-button", $scope.rejectClass = $attrs.rejectClass || "reject-button", 
        $scope.confirmClass = $attrs.confirmClass || "time-neutral-button";
    }
    return {
        template: '<div class="confirm-modal {{level}}"><h3 class="content-info" ng-bind="title"></h3><div class="confirmation-message"><h4 ng-show="confirmMessage" ng-bind="confirmMessage"></h4><ng-transclude></ng-transclude><div ng-hide="rejectable" class="input-container"><input type="button" ng-click="resolve()" class="{{confirmClass}}" value="{{resolveButton || \'OK\'}}" tabindex="1"/></div><div ng-show="rejectable" class="input-container"><input type="button" ng-click="resolve()" class="{{resolveClass}}" value="{{resolveButton || \'Yes\'}}" tabindex="1"/><input type="button" ng-click="reject()" class="{{rejectClass}}" value="{{rejectButton || \'No\'}}" tabindex="1"/></div></div></div>',
        transclude: !0,
        link: link
    };
}

function debounceFactory($timeout) {
    return function(func, wait, immediate) {
        var promise;
        return function() {
            function deferred() {
                promise = null, immediate || func.apply(ctx, args);
            }
            var ctx = this, args = arguments, callNow = immediate && !promise;
            $timeout.cancel(promise), promise = $timeout(deferred, wait), callNow && func.apply(ctx, args);
        };
    };
}

function employeeSearchCtrl($scope, accrualActiveYearsApi, accrualPeriodApi, allowanceActiveYearsApi, allowanceUtils, allowanceApi) {
    function onSelectedEmpChange() {
        getAccrualYears(), getAccruals(), getAllowanceYears(), getAllowance();
    }
    function getAccrualYears() {
        function onSuccess(response) {
            $scope.showAccrualHistory = response.years && response.years.length > 0, $scope.showAccruals = $scope.showAccrualHistory && response.years.indexOf(moment().year()) >= 0 && "TE" !== $scope.selectedEmp.payType && !$scope.selectedEmp.senator;
        }
        if ($scope.showAccrualHistory = !1, $scope.showAccruals = !1, $scope.selectedEmp) {
            var params = {
                empId: $scope.selectedEmp.empId
            };
            accrualActiveYearsApi.get(params, onSuccess, $scope.handleErrorResponse);
        }
    }
    function getAllowanceYears() {
        function onSuccess(response) {
            $scope.showAllowanceHistory = response.years && response.years.length > 0;
        }
        if ($scope.showAllowanceHistory = !1, $scope.selectedEmp) {
            var params = {
                empId: $scope.selectedEmp.empId
            };
            allowanceActiveYearsApi.get(params, onSuccess, $scope.handleErrorResponse);
        }
    }
    function getAccruals() {
        function onSuccess(resp) {
            $scope.accruals = resp.result;
        }
        if ($scope.accruals = null, !(!$scope.selectedEmp || $scope.selectedEmp.senator || [ "RA", "SA" ].indexOf($scope.selectedEmp.payType) < 0) && $scope.selectedEmp.active) {
            var params = {
                empId: $scope.selectedEmp.empId,
                beforeDate: moment().format("YYYY-MM-DD")
            };
            $scope.loadingAccruals = !0, accrualPeriodApi.get(params, onSuccess, $scope.handleErrorResponse).$promise.finally(function() {
                $scope.loadingAccruals = !1;
            });
        }
    }
    function getAllowance() {
        function onSuccess(resp) {
            $scope.allowance = resp.result[0], allowanceUtils.computeRemaining($scope.allowance, {
                beginDate: moment(),
                endDate: moment("3000-01-01")
            });
        }
        if ($scope.allowance = null, $scope.selectedEmp && !$scope.selectedEmp.senator && "TE" === $scope.selectedEmp.payType && $scope.selectedEmp.active) {
            var params = {
                empId: $scope.selectedEmp.empId,
                year: moment().year()
            };
            $scope.loadingAllowance = !0, allowanceApi.get(params, onSuccess, $scope.handleErrorResponse).$promise.finally(function() {
                $scope.loadingAllowance = !1;
            });
        }
    }
    $scope.$watch("selectedEmp", onSelectedEmpChange);
}

function employeeSelectDirective(appProps, $filter, supEmpGroupService) {
    return {
        scope: {
            selectedSup: "=?",
            selectedEmp: "=?"
        },
        restrict: "E",
        templateUrl: appProps.ctxPath + "/template/time/personnel/employee-select",
        link: function($scope, $elem, $attrs) {
            function setSelectedEmployeeGroup() {
                $scope.iSelEmpGroup < 0 || ($scope.allEmps = supEmpGroupService.getEmpInfos($scope.iSelEmpGroup, !$scope.showSenators), 
                $scope.allEmps = $scope.allEmps.filter(employeeFilter), setEmpLabels(), $scope.selectedSup = $scope.supEmpGroups[$scope.iSelEmpGroup], 
                0 === $scope.iSelEmp ? setSelectedEmployee() : $scope.iSelEmp = 0);
            }
            function setSelectedEmployee() {
                $scope.iSelEmp < 0 || ($scope.selectedEmp = $scope.allEmps[$scope.iSelEmp]);
            }
            function setSupGroupLabels() {
                angular.forEach($scope.supEmpGroups, function(empGroup) {
                    if (empGroup.supId === appProps.user.employeeId) {
                        var supName = supEmpGroupService.getName(empGroup.supId);
                        empGroup.dropDownLabel = supName.fullName;
                    } else {
                        var supId = supEmpGroupService.getSupId(empGroup.supId), supName = supEmpGroupService.getName(supId);
                        empGroup.group = "Supervisors Under " + supName.fullName, setDropDownLabel(empGroup);
                    }
                });
            }
            function setEmpLabels() {
                angular.forEach($scope.allEmps, function(emp) {
                    if (emp.empOverride) emp.group = "Employee Overrides"; else if (emp.supOverride) {
                        var supName = supEmpGroupService.getName(emp.supId);
                        emp.group = supName && supName.lastName ? $filter("possessive")(supName.lastName) + " Employees" : "Sup Override Employees";
                    } else emp.group = "Direct Employees";
                    setDropDownLabel(emp, emp.empOverride || emp.supOverride);
                });
            }
            function setDropDownLabel(emp, override) {
                var startDate = override ? emp.effectiveStartDate : emp.supStartDate, endDate = override ? emp.effectiveEndDate : emp.supEndDate, supStartMoment = moment(startDate || "1970-01-01"), supEndMoment = moment(endDate || "2999-12-31"), name = emp.empLastName + " " + emp.empFirstName[0] + ".", dates = supStartMoment.format("MMM YYYY");
                supEndMoment.isBefore(moment(), "day") ? supStartMoment.isBefore(supEndMoment, "month") && (dates += " - " + supEndMoment.format("MMM YYYY")) : dates += " - Present", 
                emp.dropDownLabel = name + " (" + dates + ")";
            }
            function employeeFilter(empInfo) {
                return activeFilter(empInfo) && senatorFilter(empInfo) && payTypeFilter(empInfo);
            }
            function activeFilter(empInfo) {
                return !$scope.activeOnly || !moment().isAfter(empInfo.effectiveEndDate || empInfo.supEndDate, "day");
            }
            function senatorFilter(empInfo) {
                return $scope.showSenators || !empInfo.senator;
            }
            function payTypeFilter(empInfo) {
                return !$scope.payTypeFilter || $scope.payTypeRegex.test(empInfo.payType);
            }
            $scope.iSelEmpGroup = -1, $scope.iSelEmp = -1, $scope.supEmpGroups = [], $scope.allEmps = [], 
            $scope.request = {
                supervisor: !1
            }, $scope.activeOnly = "true" === ($attrs.activeOnly || "").toLowerCase(), $scope.showSenators = "true" === ($attrs.showSenators || "").toLowerCase(), 
            $attrs.payType && ($scope.payTypeFilter = !0, $scope.payTypeRegex = new RegExp($attrs.payType, "i")), 
            $scope.selectSubject = $attrs.selectSubject || "info", $scope.request.supervisor = !0, 
            supEmpGroupService.init().then(function() {
                $scope.iSelEmpGroup = 0, $scope.supEmpGroups = supEmpGroupService.getSupEmpGroupList(), 
                $scope.validSupEmpGroupCount = $scope.supEmpGroups.filter($scope.supEmpGroupFilter).length, 
                setSupGroupLabels();
            }).finally(function() {
                $scope.request.supervisor = !1;
            }), $scope.$watch("iSelEmpGroup", setSelectedEmployeeGroup), $scope.$watch("iSelEmp", setSelectedEmployee), 
            $scope.supEmpGroupFilter = function(empGroup) {
                return activeFilter(empGroup);
            };
        }
    };
}

function essStorageService($window, appProps) {
    var userId = appProps.user.employeeId, keyPrefix = "nysenate.gov-" + userId + "-";
    return {
        save: function(key, value) {
            null == value ? $window.localStorage.removeItem(keyPrefix + key) : $window.localStorage.setItem(keyPrefix + key, JSON.stringify(value));
        },
        load: function(key) {
            return JSON.parse($window.localStorage.getItem(keyPrefix + key));
        },
        remove: function(key) {
            $window.localStorage.removeItem(keyPrefix + key);
        }
    };
}

function highlightFilter($sce, $sanitize) {
    return function(text, term) {
        return term ? "string" != typeof text ? text : (text = $sanitize(text), text = text.replace(new RegExp("(" + term + ")", "gi"), '<span class="highlight-filter-highlighted">$1</span>'), 
        $sce.trustAsHtml(text)) : text;
    };
}

function locationService($location, $window, $anchorScroll, appProps) {
    function setSearchParam(paramName, paramValue, condition, replace) {
        var search = $location.search(paramName, !1 !== condition ? paramValue : null);
        !1 !== replace && search.replace();
    }
    function getSearchParam(paramName) {
        return $location.search()[paramName];
    }
    function clearSearchParams() {
        $location.search({});
    }
    function scrollToId(id) {
        $location.hash(id), $anchorScroll();
    }
    function go(path, reload, params) {
        $location.path(appProps.ctxPath + path).search(params || {}), !0 === reload && setTimeout(function() {
            $window.location.reload();
        }, 0);
    }
    return {
        setSearchParam: setSearchParam,
        getSearchParam: getSearchParam,
        clearSearchParams: clearSearchParams,
        scrollToId: scrollToId,
        go: go
    };
}

function modalDirective(modals) {
    return {
        scope: {
            modalId: "@"
        },
        transclude: !0,
        template: '<div class="modal" ng-if="isOpen()" ng-class="{\'background-modal\': !isTop()}">  <ng-transclude></ng-transclude></div>',
        link: function($scope) {
            $scope.isOpen = function() {
                return modals.isOpen($scope.modalId);
            }, $scope.isTop = function() {
                return modals.isTop($scope.modalId);
            };
        }
    };
}

function phoneNumberFilter() {
    return function(tel) {
        if (!tel) return "";
        var value = tel.toString().trim().replace(/^\+/, "");
        if (value.match(/[^0-9]/)) return tel;
        var country, city, number;
        switch (value.length) {
          case 10:
            country = 1, city = value.slice(0, 3), number = value.slice(3);
            break;

          case 11:
            country = value[0], city = value.slice(1, 4), number = value.slice(4);
            break;

          case 12:
            country = value.slice(0, 3), city = value.slice(3, 5), number = value.slice(5);
            break;

          default:
            return tel;
        }
        return 1 == country && (country = ""), number = number.slice(0, 3) + "-" + number.slice(3), 
        (country + " (" + city + ") " + number).trim();
    };
}

function possessiveFilter() {
    return function(noun) {
        if (!("string" == typeof noun || noun instanceof String)) return noun;
        if (0 === noun.length) return noun;
        var possessiveNoun = noun + "'";
        return "s" !== noun.charAt(noun.length - 1).toLowerCase() && (possessiveNoun += "s"), 
        possessiveNoun;
    };
}

function registerPrintHook($rootScope, $window) {
    var beforePrint = function() {
        $rootScope.$broadcast("beforePrint"), $rootScope.$apply();
    }, afterPrint = function() {
        $rootScope.$broadcast("afterPrint"), $rootScope.$apply();
    };
    if ($window.matchMedia) {
        $window.matchMedia("print").addListener(function(mql) {
            mql.matches ? beforePrint() : afterPrint();
        });
    }
    $window.onbeforeprint = beforePrint, $window.onafterprint = afterPrint;
}

function promiseUtilsService($q) {
    function serial(tasks) {
        var prevPromise = $q.when();
        return angular.forEach(tasks, function(task) {
            prevPromise = prevPromise ? prevPromise.then(task) : task();
        }), prevPromise;
    }
    return {
        serial: serial
    };
}

function zeroPadFilter() {
    return zeroPad;
}

function zeroPad(number, length) {
    var numberString = "" + number;
    return numberString.length > length ? numberString : (Math.pow(10, length) + "" + numberString).slice(-length);
}

function errorModalTestCtrl($scope, modals) {
    $scope.testData = {
        explanation: "This is a test of the error reporting system",
        someField: "this field would normally contain error data",
        obj: {
            anotherField: "Hi mom",
            yetAnotherField: 3
        }
    }, modals.open("500", {
        action: "test error modal",
        details: $scope.testData
    });
}

var essCore = angular.module("essCore", [ "ngCookies" ]), essApi = angular.module("essApi", [ "essCore" ]), essMyInfo = angular.module("essMyInfo", [ "essApi" ]), essTime = angular.module("essTime", [ "essApi" ]), essSupply = angular.module("essSupply", [ "essApi", "ngCookies" ]), essTravel = angular.module("essTravel", [ "essApi" ]), essHelp = angular.module("essHelp", [ "essApi" ]), essApp = angular.module("ess", [ "ngRoute", "ngResource", "ngAnimate", "ngSanitize", "essCore", "essMyInfo", "essTime", "essSupply", "essTravel", "essHelp", "floatThead", "angularUtils.directives.dirPagination", "ui.autocomplete", "nsPopover", "infinite-scroll", "jlareau.bowser" ]);

essCore.constant("appProps", globalProps), essCore.run([ "$cookies", function($cookies) {
    if (void 0 === $cookies.get("appVersion") || $cookies.get("appVersion") != globalProps.releaseVersion) {
        var cookies = $cookies.getAll();
        angular.forEach(cookies, function(v, k) {
            $cookies.remove(k);
        });
    }
    $cookies.put("appVersion", globalProps.releaseVersion);
} ]), essCore.run(function() {
    $(document).unbind("keydown").bind("keydown", function(event) {
        if (8 === event.keyCode) {
            var doPrevent = !0, types = [ "text", "password", "file", "search", "email", "number", "date", "color", "datetime", "datetime-local", "month", "range", "search", "tel", "time", "url", "week" ], d = $(event.srcElement || event.target);
            if (!(d.prop("readonly") || d.prop("disabled"))) if (d[0].isContentEditable) doPrevent = !1; else if (d.is("input")) {
                var type = d.attr("type");
                type && (type = type.toLowerCase()), types.indexOf(type) > -1 && (doPrevent = !1);
            } else d.is("textarea") && (doPrevent = !1);
            if (doPrevent) return event.preventDefault(), !1;
        }
    });
}), essCore.config([ "$routeProvider", "$httpProvider", function($routeProvider, $httpProvider) {
    $httpProvider.defaults.headers.common["Cache-Control"] = "no-cache, no-store, max-age=0, must-revalidate", 
    $httpProvider.defaults.headers.common.Pragma = "no-cache", $httpProvider.defaults.headers.common.Expires = "-1";
} ]);

var essApi = angular.module("essApi");

essApi.factory("PayPeriodApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/periods/:periodType");
} ]), essApi.factory("HolidayApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/holidays");
} ]), essApi.factory("TimeRecordApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords");
} ]), essApi.factory("TimeRecordReviewApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/review");
} ]), essApi.factory("ActiveTimeRecordsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/active");
} ]), essApi.factory("ActiveYearsTimeRecordsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/activeYears");
} ]), essApi.factory("SupervisorTimeRecordsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/supervisor");
} ]), essApi.factory("SupervisorTimeRecordCountsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/supervisor/count");
} ]), essApi.factory("TimeRecordReminderApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/reminder");
} ]), essApi.factory("TimeRecordCreationApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timerecords/new");
} ]), essApi.factory("AttendanceRecordApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/attendance/records");
} ]), essApi.factory("SupervisorEmployeesApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supervisor/employees");
} ]), essApi.factory("SupervisorChainApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supervisor/chain");
} ]), essApi.factory("SupervisorOverridesApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supervisor/overrides");
} ]), essApi.factory("SupervisorGrantsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supervisor/grants");
} ]), essApi.factory("AccrualPeriodApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/accruals");
} ]), essApi.factory("AccrualActiveYearsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/accruals/active-years");
} ]), essApi.factory("AccrualHistoryApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/accruals/history");
} ]), essApi.factory("ExpectedHoursApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/expectedhrs");
} ]), essApi.factory("EmpInfoApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/employees.json");
} ]), essApi.factory("EmpActiveYearsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/employees/activeDates");
} ]), essApi.factory("EmpActiveYearsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/employees/activeYears");
} ]), essApi.factory("ActiveEmployeeApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/employees/active");
} ]), essApi.factory("EmployeeSearchApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/employees/search");
} ]), essApi.factory("AlertInfoApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/alert-info");
} ]), essApi.factory("AckDocApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/acknowledgment/documents/:ackDocId", {
        ackDocId: "@ackDocId"
    });
} ]), essApi.factory("AcknowledgmentApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/acknowledgment/acks");
} ]), essApi.factory("AcknowledgmentYearApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/acknowledgment/documents/years");
} ]), essApi.factory("EmpAckReportApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/acknowledgment/report/acks/emp");
} ]), essApi.factory("EmpTransactionsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/empTransactions/");
} ]), essApi.factory("EmpTransactionSnapshotApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/empTransactions/snapshot");
} ]), essApi.factory("EmpTransactionCurrentSnapshotApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/empTransactions/snapshot/current");
} ]), essApi.factory("EmpTransactionTimelineApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/empTransactions/timeline");
} ]), essApi.factory("AllowanceActiveYearsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/allowances/active-years");
} ]), essApi.factory("AllowanceApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/allowances");
} ]), essApi.factory("PeriodAllowanceUsageApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/allowances/period");
} ]), essApi.factory("MiscLeaveGrantApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/miscleave/grants");
} ]), essApi.factory("EmpCheckHistoryApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/paychecks.json");
} ]), essApi.factory("LocationApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/locations.json");
} ]), essApi.factory("SupplyDestinationApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/destinations/:empId.json", {
        empId: "@empId"
    });
} ]), essApi.factory("SupplyRequisitionApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions.json");
} ]), essApi.factory("SupplyRequisitionByIdApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions/:id.json", {
        id: "@id"
    });
} ]), essApi.factory("SupplyRequisitionProcessApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions/:id/process.json", {
        id: "@id"
    });
} ]), essApi.factory("SupplyRequisitionRejectApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions/:id/reject.json", {
        id: "@id"
    });
} ]), essApi.factory("SupplyRequisitionHistoryApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions/history/:id.json", {
        id: "@id"
    });
} ]), essApi.factory("SupplyRequisitionOrderHistoryApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/requisitions/orderHistory.json");
} ]), essApi.factory("SupplyEmployeesApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/employees");
} ]), essApi.factory("SupplyIssuersApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/employees/issuers.json");
} ]), essApi.factory("SupplyLocationStatisticsApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/supply/statistics/locations.json");
} ]), essApi.factory("TravelApplicationInitApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/travel/application/init/:id.json", {
        id: "@id"
    });
} ]), essApi.factory("TravelApplicationApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/travel/application.json");
} ]), essApi.factory("TravelUserConfigApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/travel/user/config");
} ]), essApi.factory("TravelUserConfigSaveApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/travel/user/config/save");
} ]), essApi.factory("TravelUserConfigDeleteApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/travel/user/config/delete");
} ]), essApi.factory("TimeoutApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/timeout/ping.json");
} ]), essApi.factory("ErrorReportApi", [ "$resource", "appProps", function($resource, appProps) {
    return $resource(appProps.apiPath + "/report/error.json");
} ]);

var essApp = angular.module("ess");

essApp.directive("essNavigation", [ "$route", "$routeParams", "$location", function($route, $routeParams, $location) {
    return {
        restrict: "A",
        link: function(scope, element, attrs) {
            element.on("click", "ul li.main-topic", function(event) {
                $(this).hasClass("active") || (element.find(".main-topic.active").removeClass("active"), 
                element.find(".sub-topic-list.active").removeClass("active"), $(this).addClass("active"), 
                $(this).next("li").children("ul.sub-topic-list").addClass("active"));
            }), scope.$on("$routeChangeStart", function() {
                element.find(".main-topic.active, .sub-topic-list.active, .sub-topic.active").removeClass("active");
                var $a = element.find(".sub-topic a[href='" + $location.$$path + "']");
                if (1 == $a.length) {
                    var $subTopicLi = $a.parent(), $subTopicUl = $subTopicLi.parent(), $mainTopic = $subTopicUl.parent().prev();
                    $subTopicLi.add($subTopicUl).add($mainTopic).addClass("active");
                }
            });
        }
    };
} ]);

var essApp = angular.module("ess");

essApp.config(function($routeProvider, $locationProvider) {
    var ctxPath = globalProps.ctxPath;
    $routeProvider.when(ctxPath + "/myinfo", {
        redirectTo: ctxPath + "/myinfo/personnel/summary"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/summary", {
        templateUrl: ctxPath + "/template/myinfo/personnel/summary"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/emergency-alert-info", {
        templateUrl: ctxPath + "/template/myinfo/personnel/emergency-alert-info"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/acknowledgments", {
        templateUrl: ctxPath + "/template/myinfo/personnel/acknowledgment"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/acknowledgments/:ackDocId", {
        templateUrl: ctxPath + "/template/myinfo/personnel/ack-doc-view"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/ack-doc-report", {
        templateUrl: ctxPath + "/template/myinfo/personnel/ack-doc-report"
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/emp-ack-doc-report", {
        templateUrl: ctxPath + "/template/myinfo/personnel/emp-ack-doc-report",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/myinfo/personnel/transactions", {
        templateUrl: ctxPath + "/template/myinfo/personnel/transactions"
    }), $routeProvider.when(ctxPath + "/myinfo/payroll/checkhistory", {
        templateUrl: ctxPath + "/template/myinfo/payroll/checkhistory"
    }), $routeProvider.when(ctxPath + "/time", {
        redirectTo: function() {
            return globalProps.userIsSenator ? globalProps.userIsSupervisor ? ctxPath + "/time/record/manage" : ctxPath + "/time/period/calendar" : ctxPath + "/time/record/entry";
        }
    }), $routeProvider.when(ctxPath + "/time/record/entry", {
        templateUrl: ctxPath + "/template/time/record/entry",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/time/record/entry/papertimesheet", {
        templateUrl: ctxPath + "/template/time/record/record-paper-entry",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/time/record/history", {
        templateUrl: ctxPath + "/template/time/record/history"
    }), $routeProvider.when(ctxPath + "/time/record/emphistory", {
        templateUrl: ctxPath + "/template/time/record/emp-history"
    }), $routeProvider.when(ctxPath + "/time/record/manage", {
        templateUrl: ctxPath + "/template/time/record/manage",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/time/record/grant", {
        templateUrl: ctxPath + "/template/time/record/grant"
    }), $routeProvider.when(ctxPath + "/time/period/calendar", {
        templateUrl: ctxPath + "/template/time/period/calendar"
    }), $routeProvider.when(ctxPath + "/time/accrual/history", {
        templateUrl: ctxPath + "/template/time/accrual/history",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/time/accrual/projections", {
        templateUrl: ctxPath + "/template/time/accrual/projections"
    }), $routeProvider.when(ctxPath + "/time/accrual/emphistory", {
        templateUrl: ctxPath + "/template/time/accrual/emp-history"
    }), $routeProvider.when(ctxPath + "/time/accrual/emp-projections", {
        templateUrl: ctxPath + "/template/time/accrual/emp-projections"
    }), $routeProvider.when(ctxPath + "/time/allowance/status", {
        templateUrl: ctxPath + "/template/time/allowance/status"
    }), $routeProvider.when(ctxPath + "/time/allowance/emp-status", {
        templateUrl: ctxPath + "/template/time/allowance/emp-status"
    }), $routeProvider.when(ctxPath + "/time/personnel/search", {
        templateUrl: ctxPath + "/template/time/personnel/search",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/time/test/errormodal", {
        templateUrl: ctxPath + "/template/time/test/error-modal-test"
    }), $routeProvider.when(ctxPath + "/supply", {
        redirectTo: ctxPath + "/supply/shopping/order"
    }), $routeProvider.when(ctxPath + "/supply/shopping/order", {
        templateUrl: ctxPath + "/template/supply/shopping/order",
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/supply/shopping/cart/cart", {
        templateUrl: ctxPath + "/template/supply/shopping/cart/cart"
    }), $routeProvider.when(ctxPath + "/supply/manage/fulfillment", {
        templateUrl: ctxPath + "/template/supply/manage/fulfillment",
        resolve: {
            locAutocomplete: [ "SupplyLocationAutocompleteService", function(locAutoService) {
                return locAutoService.initWithAllLocations();
            } ]
        },
        reloadOnSearch: !1
    }), $routeProvider.when(ctxPath + "/supply/manage/reconciliation", {
        templateUrl: ctxPath + "/template/supply/manage/reconciliation"
    }), $routeProvider.when(ctxPath + "/supply/history/requisition-history", {
        templateUrl: ctxPath + "/template/supply/history/requisition-history"
    }), $routeProvider.when(ctxPath + "/supply/history/item-history", {
        templateUrl: ctxPath + "/template/supply/history/item/item-history"
    }), $routeProvider.when(ctxPath + "/supply/history/item-history-print", {
        templateUrl: ctxPath + "/template/supply/history/item/item-history-print"
    }), $routeProvider.when(ctxPath + "/supply/history/order-history", {
        templateUrl: ctxPath + "/template/supply/history/order-history"
    }), $routeProvider.when(ctxPath + "/supply/requisition/requisition-view", {
        templateUrl: ctxPath + "/template/supply/requisition/requisition-view"
    }), $routeProvider.when(ctxPath + "/travel", {
        redirectTo: ctxPath + "travel/application/travel-application"
    }), $routeProvider.when(ctxPath + "/travel/application/travel-application", {
        templateUrl: ctxPath + "/template/travel/application/travel-application"
    }), $routeProvider.when(ctxPath + "/travel/view-applications", {
        templateUrl: ctxPath + "/template/travel/view-applications"
    }), $routeProvider.when(ctxPath + "/travel/travel-user-config", {
        templateUrl: ctxPath + "/template/travel/travel-user-config"
    }), $routeProvider.when(ctxPath + "/travel/manage/travel-manage-history", {
        templateUrl: ctxPath + "/template/travel/manage/travel-manage-history"
    }), $routeProvider.when(ctxPath + "/help/ta/plan", {
        templateUrl: ctxPath + "/template/help/ta/plan"
    }), $routeProvider.when(ctxPath + "/logout", {}), $routeProvider.when(ctxPath + "/login", {}), 
    $routeProvider.otherwise({
        templateUrl: ctxPath + "/template/404"
    }), $locationProvider.html5Mode(!0), $locationProvider.hashPrefix("!");
}), essApp.animation(".view-animate", function() {
    return {
        enter: function(element, done) {
            return element.hide(), element.delay(150).fadeIn(300, done), function() {
                element.stop();
            };
        },
        leave: function(element, done) {
            return element.fadeOut(100, done), function() {
                element.stop();
            };
        }
    };
});

var essApp = angular.module("ess");

essApp.controller("MainCtrl", [ "$scope", "$http", "$route", "$routeParams", "$location", "$window", "appProps", "modals", "RestErrorService", function($scope, $http, $route, $routeParams, $location, $window, appProps, modals, RestErrorService) {
    $scope.$route = $route, $scope.$location = $location, $scope.$routeParams = $routeParams, 
    $scope.ctxPath = appProps.ctxPath, $scope.helpPageUrl = appProps.ctxPath + "/assets/help/html/index.htm";
    $scope.openHelpWindow = function($event) {
        $window.open($scope.helpPageUrl, "helpWindow", "width=1024,height=768,location=no,menubar=no,personalbar=no,status=no,titlebar=no,toolbar=no"), 
        $event.preventDefault();
    }, $scope.handleErrorResponse = RestErrorService.handleErrorResponse;
} ]);

var essApp = angular.module("ess");

essApp.filter("activeInactive", function() {
    return function(input) {
        return "A" === input || "a" === input ? "Active" : "Inactive";
    };
});

var essApp = angular.module("ess");

essApp.directive("badge", [ "$rootScope", "badgeService", function($rootScope, badgeService) {
    return {
        restrict: "AE",
        scope: {
            badgeId: "&",
            hideEmpty: "&"
        },
        template: '<div class="badge" ng-if="!hideEmpty || badgeValue">{{badgeValue}}</div>',
        link: function($scope, element, attrs) {
            $scope.$watch(function() {
                return badgeService.badges[attrs.badgeId];
            }, function(newVal) {
                $scope.badgeValue = newVal;
            });
        }
    };
} ]);

var essApp = angular.module("ess");

essApp.factory("badgeService", [ "appProps", function(appProps) {
    var badgeService = {
        badges: {}
    };
    return badgeService.setBadgeValue = function(badgeId, value) {
        badgeService.badges[badgeId] = value;
    }, badgeService;
} ]), angular.module("ess").directive("progressModal", [ progressModal ]).directive("confirmModal", [ "modals", confirmModal ]);

var essApp = angular.module("ess");

essApp.directive("datepicker", [ function() {
    return {
        restrict: "AE",
        scope: {
            stepMonths: "@",
            inline: "@",
            defaultDate: "@",
            beforeShowDay: "&?",
            fromDate: "=?",
            toDate: "=?"
        },
        link: function($scope, $element, $attrs) {
            function validDay(date) {
                return $scope.fromDate ? !moment($scope.fromDate).isAfter(date) : !$scope.toDate || !moment($scope.toDate).isBefore(date);
            }
            function beforeShowDay(date) {
                var beforeShowDayResult = [ !0 ];
                return "function" == typeof customBeforeShowDay && (beforeShowDayResult = customBeforeShowDay(date)), 
                beforeShowDayResult[0] = beforeShowDayResult[0] && validDay(date), beforeShowDayResult;
            }
            var defaultDate = $scope.defaultDate ? $scope.defaultDate : new Date(), customBeforeShowDay = void 0;
            "function" == typeof $scope.beforeShowDay && (customBeforeShowDay = $scope.beforeShowDay()), 
            $element.datepicker({
                showOn: "button",
                buttonImage: "/assets/img/calendar.png",
                buttonImageOnly: !0,
                inline: $scope.inline || !1,
                stepMonths: $scope.stepMonths || 1,
                defaultDate: defaultDate,
                beforeShowDay: beforeShowDay
            }), "false" === $scope.stepMonths && $element.find(".ui-datepicker-prev, .ui-datepicker-next").remove();
        }
    };
} ]), angular.module("ess").factory("debounce", [ "$timeout", debounceFactory ]), 
angular.module("ess").controller("EmployeeSearchCtrl", [ "$scope", "AccrualActiveYearsApi", "AccrualPeriodApi", "AllowanceActiveYearsApi", "AllowanceUtils", "AllowanceApi", employeeSearchCtrl ]), 
angular.module("ess").directive("employeeSearch", [ "appProps", "modals", "LocationService", "EmployeeSearchApi", "EmpInfoApi", "PaginationModel", "RestErrorService", function(appProps, modals, locationService, employeeSearchApi, empInfoApi, paginationModel, RestErrorService) {
    return {
        scope: {
            selectedEmp: "=?"
        },
        restrict: "E",
        templateUrl: appProps.ctxPath + "/template/time/personnel/employee-search-directive",
        link: function($scope, $elem, $attrs) {
            function getSearchResults() {
                function onSuccess(resp) {
                    resp.employees.forEach(function(emp) {
                        $scope.searchResults.push(emp);
                    }), pagination.setTotalItems(resp.total), validEmpId() && $scope.searchResults.length > 0 && ($scope.selectEmp($scope.searchResults[0]), 
                    empId = NaN);
                }
                $scope.loadingEmps = !0;
                var params = {
                    term: $scope.searchTerm,
                    empId: validEmpId() ? empId : 0,
                    limit: pagination.getLimit(),
                    offset: pagination.getOffset()
                };
                return employeeSearchApi.get(params, onSuccess, $scope.handleErrorResponse).$promise.finally(function() {
                    $scope.loadingEmps = !1;
                });
            }
            function getEmpInfo() {
                function onSuccess(resp) {
                    $scope.empInfo = resp.employee;
                }
                var params = {
                    empId: $scope.selectedEmp.empId,
                    detail: !0
                };
                return $scope.loadingEmpInfo = !0, empInfoApi.get(params, onSuccess, RestErrorService.handleErrorResponse).$promise.finally(function() {
                    $scope.loadingEmpInfo = !1;
                });
            }
            function newSearch() {
                return $scope.searchResults = [], pagination.reset(), locationService.setSearchParam(TERM_PARAM, $scope.searchTerm, /\S/.test($scope.searchTerm)), 
                getSearchResults();
            }
            function validEmpId() {
                return !isNaN(parseInt(empId)) && empId > 0;
            }
            var TERM_PARAM = "term";
            $scope.selectedEmp = null, $scope.empInfo = null, $scope.searchTerm = locationService.getSearchParam(TERM_PARAM) || "", 
            $scope.searchResults = [];
            var empId = parseInt(locationService.getSearchParam("empId") || NaN), pagination = angular.copy(paginationModel);
            pagination.itemsPerPage = 50, $scope.$watch("searchTerm", newSearch), $scope.searchResultsExist = function() {
                return $scope.searchResults && $scope.searchResults.length > 0;
            }, $scope.getNextSearchResults = function() {
                if (!$scope.loadingEmps && !pagination.onLastPage()) return pagination.nextPage(), 
                getSearchResults();
            }, $scope.selectEmp = function(emp) {
                $scope.selectedEmp = emp, getEmpInfo(), locationService.setSearchParam("empId", emp.empId);
            }, $scope.clearSelectedEmp = function() {
                $scope.selectedEmp = null, $scope.empInfo = null, empId = NaN, locationService.setSearchParam("empId"), 
                $scope.$apply(), getSearchResults();
            };
        }
    };
} ]), angular.module("ess").directive("employeeSelect", [ "appProps", "$filter", "supEmpGroupService", employeeSelectDirective ]), 
angular.module("ess").directive("errSrc", function() {
    return {
        link: function(scope, element, attrs) {
            element.bind("error", function() {
                attrs.src != attrs.errSrc && attrs.$set("src", attrs.errSrc);
            });
        }
    };
});

var essApp = angular.module("ess");

essApp.directive("essNotification", [ function() {
    return {
        restrict: "AE",
        scope: {
            level: "@",
            title: "@",
            message: "@",
            dialog: "@",
            dialogShow: "@"
        },
        transclude: !0,
        template: '<div class="ess-notification {{level}}"><h2 ng-if="title" ng-bind="title"></h2><p ng-if="message" ng-bind="message"></p><ng-transclude></ng-transclude></div>',
        link: function(scope, element, attrs) {
            "true" === scope.dialog && ($elem = jQuery(element), $elem && $elem.dialog({
                autoOpen: !1,
                height: "auto",
                width: "auto",
                modal: !0
            }), scope.$watch("dialogShow", function(newVal, oldVal) {
                "true" === newVal && $elem.dialog("open");
            }));
        }
    };
} ]);

var ess = angular.module("ess");

ess.service("EssStorageService", [ "$window", "appProps", essStorageService ]);

var essApp = angular.module("ess");

essApp.directive("essChart", [ function() {
    return {
        restrict: "AE",
        link: function(scope, element, attrs) {
            element.highcharts({});
        }
    };
} ]), angular.module("ess").filter("highlight", [ "$sce", "$sanitize", highlightFilter ]), 
angular.module("ess").directive("iframeOnLoad", function() {
    return {
        restrict: "A",
        scope: {
            callback: "&iframeOnLoad"
        },
        link: function($scope, $elem, $attrs) {
            $elem.on("load", function() {
                return $scope.callback({
                    elem: $elem
                });
            });
        }
    };
});

var essApp = angular.module("ess");

essApp.directive("internalErrorModal", [ "modals", "ErrorReportApi", "appProps", function(modals, errorReportApi, appProps) {
    return {
        template: '<section id="internal-error-modal" title="Internal Error"><h1>Internal Error</h1><p class="internal-error-text">We are sorry to report that an error occurred on the ESS server while processing your request.<br/>Please contact the STS Helpline at (518) 455-2011 and notify us of this issue so that we can fix it!</p><pre class="internal-error-details" ng-show="showDetails">{{details | json}}</pre><p style="color: red" ng-show="showFailure">Sorry, your report cannot be sent.  Please contact the STS Helpline at (518) 455-2011.</p><div ng-show="sendingReport"><h3 class="loading-text">Sending Error Report ...</h3><div loader-indicator class="sm-loader"></div></div><div class="button-container"><input type="button" class="reject-button" value="{{showDetails ? \'Hide\' : \'Show\'}} Details"ng-click="showDetails = !showDetails" /><input type="button" class="reject-button" value="Report Error"ng-click="report()" ng-disabled="sendingReport" /><input type="button" class="reject-button" value="OK"ng-click="close()" ng-disabled="sendingReport" /></div></section>',
        link: function($scope, $element, $attrs) {
            $scope.showDetails = !1, $scope.showFailure = !1, $scope.sendingReport = !1, $scope.details = modals.params().details, 
            $scope.report = function() {
                var params = {
                    user: appProps.user.employeeId,
                    url: window.location.href,
                    details: $scope.details
                };
                $scope.sendingReport = !0, errorReportApi.save(params, function(resp) {
                    modals.resolve();
                }, function(resp) {
                    $scope.showFailure = !0;
                }).$promise.finally(function() {
                    $scope.sendingReport = !1;
                });
            }, $scope.close = modals.reject;
        }
    };
} ]);

var essApp = angular.module("ess");

essApp.directive("loaderIndicator", [ function() {
    return {
        restrict: "A",
        template: '<div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div><div class="dot dot4"></div>',
        link: function(scope, element, attrs) {}
    };
} ]), angular.module("ess").service("LocationService", [ "$location", "$window", "$anchorScroll", "appProps", locationService ]), 
angular.module("ess").directive("modalCloseButton", [ "modals", function(modals) {
    return {
        template: '<div class="icon-cross modal-close-button" ng-click="rejectModal()"></div>',
        link: function($scope) {
            $scope.rejectModal = function() {
                modals.reject();
            };
        }
    };
} ]);

var essApp = angular.module("ess");

essApp.directive("modalContainer", [ "$rootScope", "$document", "modals", function($rootScope, $document, modals) {
    function link($scope, $element, $attrs, $ctrl, $transclude) {
        function onModalUpdate() {
            $scope.isOpen() ? lockScrollbar() : unlockScrollbar();
        }
        function lockScrollbar() {
            angular.element("html").addClass("overflow-hidden");
        }
        function unlockScrollbar() {
            angular.element("html").removeClass("overflow-hidden");
        }
        var backDropEle = $element.find("#modal-backdrop")[0];
        backDropEle.onclick = function(event) {
            backDropEle === event.target && $scope.$apply(modals.softReject);
        }, $document.bind("keyup", function(event) {
            27 === event.keyCode && $scope.$apply(modals.softReject);
        }), $rootScope.$on("modals.open", function(event, modalId) {
            onModalUpdate();
        }), $rootScope.$on("modals.close", function(event) {
            onModalUpdate();
        }), $scope.isOpen = function() {
            return modals.isOpen();
        };
    }
    return {
        template: '<div id="modal-container" ng-show="isOpen()">  <div id="modal-backdrop"></div>  <div id="common-modals">    <modal modal-id="500"><div internal-error-modal></div></modal>    <modal modal-id="timeout"><div timeout-modal></div></modal>  </div>  <ng-transclude id="custom-modals"></ng-transclude>  <div id="modal-display"></div></div>',
        transclude: !0,
        link: link
    };
} ]), essApp.directive("modal", [ "modals", modalDirective ]);

var essApp = angular.module("ess");

essApp.service("modals", [ "$rootScope", "$q", function($rootScope, $q) {
    function open(modalId, params, softRejectable) {
        if (!modalId) return $q.defer();
        var modal = {
            modalId: modalId,
            deferred: $q.defer(),
            params: params,
            softRejectable: !0 === softRejectable
        };
        return modal.deferred.promise.then(function() {}, function() {}), modals.unshift(modal), 
        $rootScope.$emit("modals.open", modalId), modal.deferred.promise;
    }
    function isOpen(modalId) {
        if (void 0 === modalId) return modals.length > 0;
        var found = !1;
        return angular.forEach(modals, function(modal) {
            modal.modalId === modalId && (found = !0);
        }), found;
    }
    function isTop(modalId) {
        return modals.length > 0 && modals[0].modalId === modalId;
    }
    function params() {
        var modal = modals[0];
        return modal ? modal.params || {} : {};
    }
    function reject(reason) {
        var modal = modals.shift();
        modal && (modal.deferred.reject(reason), $rootScope.$emit("modals.close"));
    }
    function rejectAll(reason) {
        for (;modals.length > 0; ) reject(reason);
    }
    function softReject(reason) {
        var modal = modals[0];
        modal && modal.softRejectable && reject(reason);
    }
    function resolve(response) {
        var modal = modals.shift();
        modal && (modal.deferred.resolve(response), $rootScope.$emit("modals.close"));
    }
    var modals = [];
    return {
        open: open,
        isOpen: isOpen,
        isTop: isTop,
        params: params,
        reject: reject,
        rejectAll: rejectAll,
        softReject: softReject,
        resolve: resolve
    };
} ]);

var essApp = angular.module("ess");

essApp.filter("moment", [ "$filter", function($filter) {
    return function(input, format, defaultVal) {
        return input ? moment(input).format(format) : void 0 !== defaultVal ? defaultVal : "--";
    };
} ]), essApp.filter("momentFromNow", function() {
    return function(input, suffix, defaultVal) {
        return suffix = !0 === suffix, input ? moment(input).fromNow(suffix) : void 0 !== defaultVal ? defaultVal : "--";
    };
}), essApp.filter("momentCmp", function() {
    return function(lhs, operator, rhs, precision) {
        switch ("now" === rhs && (rhs = moment()), operator) {
          case "eq":
          case "=":
            return moment(lhs).isSame(rhs, precision);

          case "gt":
          case ">":
            return moment(lhs).isAfter(rhs, precision);

          case "lt":
          case "<":
            return moment(lhs).isBefore(rhs, precision);

          default:
            return !1;
        }
    };
}), essApp.filter("momentIsDOW", function() {
    return function(date, daysOfWeek) {
        return daysOfWeek.constructor !== Array && (daysOfWeek = [ daysOfWeek ]), daysOfWeek.indexOf(moment(date).day()) >= 0;
    };
});

var essApp = angular.module("ess");

essApp.filter("not", function() {
    return function(input) {
        return !input;
    };
});

var essApp = angular.module("ess");

essApp.directive("odometer", [ function() {
    return {
        restrict: "AE",
        scope: {
            duration: "=odometerDuration",
            format: "=odometerFormat",
            value: "@value"
        },
        link: function($scope, element, attrs) {
            var od = new Odometer({
                el: element[0],
                value: $scope.value || 0,
                animation: "count",
                duration: $scope.duration || 500,
                format: $scope.format || "(,ddd).dd"
            });
            attrs.$observe("value", function(val) {
                od.update(val);
            });
        }
    };
} ]), angular.module("ess").directive("onScrollToBottom", function() {
    return {
        restrict: "A",
        link: function(scope, element, attrs) {
            var raw = element[0];
            element.bind("scroll", function() {
                raw.scrollTop + raw.offsetHeight > raw.scrollHeight && scope.$apply(attrs.onScrollToBottom);
            });
        }
    };
});

var essApp = angular.module("ess");

essApp.factory("PaginationModel", function() {
    return {
        firstPage: 1,
        currPage: 1,
        lastPage: 1,
        itemsPerPage: 6,
        totalItems: 0,
        setTotalItems: function(totalResults) {
            this.totalItems = totalResults, this.lastPage = Math.ceil(this.totalItems / this.itemsPerPage), 
            this.currPage > this.lastPage && (this.currPage = 1);
        },
        reset: function() {
            this.currPage = 1;
        },
        needsPagination: function() {
            return this.totalItems > this.itemsPerPage;
        },
        onLastPage: function() {
            return this.currPage >= this.lastPage;
        },
        getOffset: function() {
            return this.itemsPerPage * (this.currPage - 1) + 1;
        },
        getLimit: function() {
            return this.itemsPerPage;
        },
        nextPage: function() {
            this.currPage += 1;
        },
        hasNextPage: function() {
            return this.currPage < this.lastPage;
        },
        prevPage: function() {
            this.currPage = Math.max(this.currPage - 1, 0);
        },
        hasPrevPage: function() {
            return this.currPage > this.firstPage;
        },
        toLastPage: function() {
            this.currPage = this.lastPage;
        },
        toFirstPage: function() {
            this.currPage = this.firstPage;
        }
    };
}), angular.module("ess").filter("phoneNumber", phoneNumberFilter), angular.module("ess").filter("possessive", possessiveFilter), 
angular.module("ess").run([ "$rootScope", "$window", registerPrintHook ]), angular.module("ess").service("promiseUtils", [ "$q", promiseUtilsService ]), 
angular.module("ess").service("RestErrorService", [ "$location", "modals", function($location, modals) {
    function handleErrorResponse(resp) {
        "UNAUTHENTICATED" === (resp.data.status || {}).code ? $location.path(appProps.loginUrl) : modals.open("500", {
            details: resp
        });
    }
    return {
        handleErrorResponse: handleErrorResponse
    };
} ]);

var essApp = angular.module("ess");

essApp.filter("round", function() {
    return function(number, multiple, direction) {
        multiple = Math.abs(multiple || 1), direction = isNaN(direction) ? 0 : direction;
        var roundingFunction = Math.round;
        direction > 0 ? roundingFunction = Math.ceil : direction < 0 && (roundingFunction = Math.floor);
        var inverse = 1 / multiple;
        return roundingFunction(number * inverse) / inverse;
    };
});

var essApp = angular.module("ess");

essApp.directive("textAutoHeight", [ "$timeout", function($timeout) {
    return {
        restrict: "A",
        scope: {
            text: "="
        },
        link: function($scope, $elem, $attrs) {
            $timeout(function() {
                var minHeight = $elem[0].offsetHeight, paddingLeft = parseInt($elem.css("paddingLeft")) || 0, paddingRight = parseInt($elem.css("paddingRight")) || 0, $shadow = angular.element("<div></div>").css({
                    position: "absolute",
                    top: -1e4,
                    left: -1e4,
                    width: $elem[0].offsetWidth - paddingLeft - paddingRight,
                    fontSize: $elem.css("fontSize"),
                    fontFamily: $elem.css("fontFamily"),
                    lineHeight: $elem.css("lineHeight"),
                    resize: "none"
                });
                $scope.$watch(function() {
                    return $elem[0].offsetWidth;
                }, function(newWidth, oldWidth) {
                    newWidth !== oldWidth && $timeout(function() {
                        var paddingLeft = parseInt($elem.css("paddingLeft")) || 0, paddingRight = parseInt($elem.css("paddingRight")) || 0;
                        $shadow.css("width", newWidth - paddingLeft - paddingRight);
                    }, 50);
                }), angular.element(document.body).append($shadow);
                var update = function() {
                    var times = function(string, number) {
                        for (var i = 0, r = ""; i < number; i++) r += string;
                        return r;
                    }, val = $elem.val().replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/&/g, "&amp;").replace(/\n$/, "<br/>&nbsp;").replace(/\n/g, "<br/>").replace(/\s{2,}/g, function(space) {
                        return times("&nbsp;", space.length - 1) + " ";
                    });
                    $shadow.html(val), $elem.css("height", Math.max($shadow[0].offsetHeight + 10, minHeight) + "px");
                };
                $elem.bind("keyup keydown keypress change", update), update();
            }, 100);
        }
    };
} ]), angular.module("ess").run([ "$window", "$document", "appProps", "modals", "LocationService", "TimeoutApi", function($window, $document, appProps, modals, LocationService, TimeoutApi) {
    function logout() {
        LocationService.go("/logout", !0);
    }
    function pingServer() {
        var params = {
            active: active
        };
        TimeoutApi.save(params, {}, onPingSuccess, onPingFail);
    }
    function onPingSuccess(resp) {
        failedPings = 0;
        var remainingInactivity = resp.remainingInactivity;
        remainingInactivity < 0 ? logout() : remainingInactivity <= warningThreshold && !modals.isOpen(timeoutModalName) && modals.open(timeoutModalName, {
            remainingInactivity: remainingInactivity
        }), active = !1;
    }
    function onPingFail(resp) {
        var errorCode = resp.status;
        failedPings++, (401 === errorCode || failedPings >= pingFailTolerance) && logout();
    }
    var timeoutModalName = "timeout", warningThreshold = 70, active = !0, pingFailTolerance = 10, failedPings = 0;
    pingServer(), $window.setInterval(function() {
        pingServer();
    }, 3e4), $document.on("change click keydown keypress keyup load resize scroll select submit", function() {
        active || modals.isOpen(timeoutModalName) || (active = !0);
    });
} ]);

var essApp = angular.module("ess");

essApp.directive("timeoutModal", [ "modals", "$interval", "LocationService", "TimeoutApi", function(modals, $interval, locationService, TimeoutApi) {
    return {
        template: '<section id="timeout-modal" title="Inactivity Warning"><h1>Inactive Session Timeout</h1><p class="timeout-text">Due to inactivity, you will be logged out in {{timeRemaining}} seconds.<br>Do you want to continue your work?</p><div class="button-container"><input type="button" ng-click="logout()" ng-disabled="disableButtons()"\nclass="reject-button" value="Log out of ESS"/><input type="button" ng-click="close()" ng-disabled="disableButtons()"\nclass="submit-button" value="Continue"/></div></section>',
        link: function($scope, $element, $attrs) {
            $scope.sendingPing = !1, $scope.timeRemaining = modals.params().remainingInactivity, 
            $scope.timeRemaining -= 1;
            var countdown = $interval(function() {
                $scope.timeRemaining > 0 ? $scope.timeRemaining-- : $scope.logout();
            }, 1e3);
            $scope.$on("$destroy", function() {
                $interval.cancel(countdown);
            }), $scope.close = function() {
                $interval.cancel(countdown), $scope.sendingPing = !0;
                var params = {
                    active: !0
                }, body = {};
                TimeoutApi.save(params, body, modals.reject, $scope.logout);
            }, $scope.logout = function() {
                locationService.go("/logout", !0);
            }, $scope.disableButtons = function() {
                return $scope.sendingPing || $scope.timeRemaining <= 0;
            };
        }
    };
} ]);

var essApp = angular.module("ess");

essApp.directive("togglePanel", [ "$timeout", "$rootScope", function($timeout, $rootScope) {
    return {
        restrict: "E",
        scope: {
            label: "@",
            extraClasses: "@",
            callback: "&",
            renderClosed: "@"
        },
        replace: !0,
        transclude: !0,
        template: '<div class="content-container {{extraClasses}}" ng-class="{\'open\': open}">  <div class="toggle-panel" ng-click="toggle()">    <h1 class="toggle-panel-label">{{label}}</h1>    <span class="toggle-panel-status">      <span class="toggle-panel-tip" ng-hide="open">        (Click to expand section)      </span>      <i ng-class="{\'icon-chevron-up\': open, \'icon-chevron-down\': !open}"></i>    </span>  </div>  <div ng-if="opened || renderClosed" ng-show="open" class="panel-content" ng-cloak ng-transclude></div></div>',
        link: function($scope, $element, $attrs) {
            $scope.opened = !1, $scope.toggle = function() {
                $scope.open = !$scope.open, $scope.callback && $scope.callback($scope.open), $timeout(function() {
                    $rootScope.$emit("reflowEvent");
                });
            }, $scope.renderClosed = "true" == $scope.renderClosed, $scope.$watch($attrs.open, function(open) {
                $scope.open = open;
            }), $scope.$watch($attrs.showTip, function(showTip) {
                $scope.showTip = showTip;
            }), $scope.$watch("open", function(newOpen, oldOpen) {
                var panelElem = $element.children(".panel-content");
                newOpen ? panelElem.slideDown(200) : panelElem.slideUp(200), $scope.opened = newOpen || $scope.opened;
            });
        }
    };
} ]), angular.module("ess").filter("zeroPad", zeroPadFilter), angular.module("ess").controller("ErrorModalTestCtrl", [ "$scope", "modals", errorModalTestCtrl ]);
//# sourceMappingURL=ess.min.js.map